{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 36, "column": 0}, "map": {"version":3,"sources":["file:///home/user/tienda/src/lib/firebase/server.ts"],"sourcesContent":["\nimport { getApps, initializeApp, cert, App } from \"firebase-admin/app\";\nimport { getAuth } from \"firebase-admin/auth\";\nimport { getFirestore } from \"firebase-admin/firestore\";\n\nlet app: App;\n\nif (!getApps().length) {\n  try {\n    const serviceAccountJson = process.env.FIREBASE_SERVICE_ACCOUNT_JSON;\n\n    if (!serviceAccountJson) {\n      throw new Error(\"La variable de entorno FIREBASE_SERVICE_ACCOUNT_JSON no est谩 configurada. Pega el contenido de tu archivo JSON de cuenta de servicio en el archivo .env.\");\n    }\n\n    const serviceAccount = JSON.parse(serviceAccountJson);\n\n    app = initializeApp({\n      credential: cert(serviceAccount),\n    });\n  } catch (error: any) {\n    let errorMessage = \"No se pudo inicializar Firebase Admin. Revisa tus credenciales en el archivo .env.\";\n    if (error.message.includes(\"Unexpected token\")) {\n        errorMessage += \" El valor de FIREBASE_SERVICE_ACCOUNT_JSON parece no ser un JSON v谩lido.\";\n    } else {\n        errorMessage += \" El error fue: \" + error.message;\n    }\n    console.error(\"Error de Inicializaci贸n de Firebase Admin:\", errorMessage);\n    throw new Error(errorMessage);\n  }\n} else {\n  app = getApps()[0]!;\n}\n\nconst adminAuth = getAuth(app);\nconst adminDb = getFirestore(app);\n\nexport { adminAuth, adminDb };\n"],"names":[],"mappings":";;;;;;AACA;AACA;AACA;;;;;;;;;;AAEA,IAAI;AAEJ,IAAI,CAAC,IAAA,2JAAO,IAAG,MAAM,EAAE;IACrB,IAAI;QACF,MAAM,qBAAqB,QAAQ,GAAG,CAAC,6BAA6B;QAEpE,IAAI,CAAC,oBAAoB;YACvB,MAAM,IAAI,MAAM;QAClB;QAEA,MAAM,iBAAiB,KAAK,KAAK,CAAC;QAElC,MAAM,IAAA,iKAAa,EAAC;YAClB,YAAY,IAAA,wJAAI,EAAC;QACnB;IACF,EAAE,OAAO,OAAY;QACnB,IAAI,eAAe;QACnB,IAAI,MAAM,OAAO,CAAC,QAAQ,CAAC,qBAAqB;YAC5C,gBAAgB;QACpB,OAAO;YACH,gBAAgB,oBAAoB,MAAM,OAAO;QACrD;QACA,QAAQ,KAAK,CAAC,8CAA8C;QAC5D,MAAM,IAAI,MAAM;IAClB;AACF,OAAO;IACL,MAAM,IAAA,2JAAO,GAAE,CAAC,EAAE;AACpB;AAEA,MAAM,YAAY,IAAA,6JAAO,EAAC;AAC1B,MAAM,UAAU,IAAA,4KAAY,EAAC","debugId":null}},
    {"offset": {"line": 164, "column": 0}, "map": {"version":3,"sources":["file:///home/user/tienda/src/lib/firebase/client.ts"],"sourcesContent":["// src/lib/firebase/client.ts\nimport { initializeApp, getApps, getApp, type FirebaseApp } from \"firebase/app\";\nimport { getAuth, type Auth } from \"firebase/auth\";\nimport { getFirestore, type Firestore } from \"firebase/firestore\";\nimport { getStorage, type FirebaseStorage } from \"firebase/storage\";\nimport { getFunctions } from \"firebase/functions\";\n\n//  Configuraci贸n de Firebase desde variables de entorno\nconst firebaseConfig = {\n  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY!,\n  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN!,\n  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID!,\n  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET!,\n  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID!,\n  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID!,\n};\n\n//  Singleton: inicializa Firebase una sola vez\nfunction getFirebaseApp(): FirebaseApp {\n  if (!getApps().length) {\n    return initializeApp(firebaseConfig);\n  }\n  return getApp();\n}\n\n//  Inicializaciones (ya nunca son null)\nconst app: FirebaseApp = getFirebaseApp();\nconst auth: Auth = getAuth(app);\nconst db: Firestore = getFirestore(app);\nconst storage: FirebaseStorage = getStorage(app);\nconst functions = getFunctions(app);\n\n//  Exportamos para usar en cualquier parte del cliente\nexport { app, auth, db, storage, functions, db as firestore };\n"],"names":[],"mappings":"AAAA,6BAA6B;;;;;;;;;;;;;;;AAC7B;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;;;;;;AAEA,0DAA0D;AAC1D,MAAM,iBAAiB;IACrB,MAAM;IACN,UAAU;IACV,SAAS;IACT,aAAa;IACb,iBAAiB;IACjB,KAAK;AACP;AAEA,iDAAiD;AACjD,SAAS;IACP,IAAI,CAAC,IAAA,+KAAO,IAAG,MAAM,EAAE;QACrB,OAAO,IAAA,qLAAa,EAAC;IACvB;IACA,OAAO,IAAA,8KAAM;AACf;AAEA,0CAA0C;AAC1C,MAAM,MAAmB;AACzB,MAAM,OAAa,IAAA,yMAAO,EAAC;AAC3B,MAAM,KAAgB,IAAA,iLAAY,EAAC;AACnC,MAAM,UAA2B,IAAA,kMAAU,EAAC;AAC5C,MAAM,YAAY,IAAA,0LAAY,EAAC","debugId":null}},
    {"offset": {"line": 223, "column": 0}, "map": {"version":3,"sources":["file:///home/user/tienda/src/lib/actions/setup.ts"],"sourcesContent":["\n\n\n'use server';\n\nimport type { InitialAdminData, User, Category, NewUserData, Product, Sale, CashOutflow, Inflow, Currency, CashTransfer, Company, UserRole, OrderItem, OrderDraft } from \"@/lib/types\";\nimport { adminDb, adminAuth } from \"../firebase/server\";\nimport { FieldValue } from \"firebase-admin/firestore\";\nimport { getFunctions, httpsCallable, HttpsCallable } from \"firebase/functions\";\nimport { reauthenticateWithCredential, EmailAuthProvider, signInWithEmailAndPassword } from \"firebase/auth\";\nimport { auth as clientAuth, app as clientApp } from \"../firebase/client\";\n\n// Cart type for server action\ntype PlainCartItem = {\n    id: string;\n    quantityInCart: number;\n    name: string;\n}\n\n\n// -----------------\n// Helpers Admin\n// -----------------\nconst getAdminDbOrThrow = () => {\n  if (!adminDb) throw new Error(\"La base de datos de administrador no est谩 configurada.\");\n  return adminDb;\n};\n\nconst getAdminAuthOrThrow = () => {\n  if (!adminAuth) throw new Error(\"La autenticaci贸n de administrador no est谩 configurada.\");\n  return adminAuth;\n};\n\nexport async function getCompanyIdForUser(userId: string): Promise<string> {\n    const db = getAdminDbOrThrow();\n    const userRef = db.doc(`users/${userId}`);\n    const userSnap = await userRef.get();\n    if (!userSnap.exists || !userSnap.data()?.companyId) {\n        throw new Error(\"Usuario no asociado a ninguna empresa.\");\n    }\n    return userSnap.data()!.companyId;\n};\n\n// -----------------\n// Setup inicial\n// -----------------\nexport async function isInitialSetupRequired(): Promise<boolean> {\n  const db = getAdminDbOrThrow();\n  const companiesCol = db.collection(\"companies\");\n  const snapshot = await companiesCol.limit(1).get();\n  return snapshot.empty;\n};\n\nexport async function createInitialAdminUser(data: Omit<InitialAdminData, 'secretCode'>) {\n  const db = getAdminDbOrThrow();\n  const auth = getAdminAuthOrThrow();\n  const companyRef = db.collection(\"companies\").doc();\n  const userRecord = await auth.createUser({\n    email: data.email,\n    password: data.password,\n    displayName: data.adminName,\n  });\n\n  await auth.setCustomUserClaims(userRecord.uid, {\n    role: \"primary-admin\",\n    companyId: companyRef.id,\n  });\n\n  const batch = db.batch();\n\n  batch.set(companyRef, {\n    id: companyRef.id,\n    name: data.companyName,\n    ownerUid: userRecord.uid,\n    exchangeRate: 36.5,\n    pettyCashInitial: 0,\n    createdAt: FieldValue.serverTimestamp(),\n    logoUrl: \"\",\n    securityCodeSet: false, // Initialize security code status\n  });\n\n  const userRef = db.doc(`users/${userRecord.uid}`);\n  batch.set(userRef, {\n    uid: userRecord.uid,\n    name: data.adminName,\n    email: data.email,\n    role: \"primary-admin\",\n    companyId: companyRef.id,\n    createdAt: FieldValue.serverTimestamp(),\n  });\n\n  await batch.commit();\n\n  return { uid: userRecord.uid, companyId: companyRef.id };\n};\n\n// -----------------\n// Company Settings\n// -----------------\n\nexport async function updateCompanySettings(settings: Partial<Pick<Company, 'exchangeRate' | 'pettyCashInitial' | 'name' | 'logoUrl'>>, userId: string): Promise<void> {\n    const db = getAdminDbOrThrow();\n    const companyId = await getCompanyIdForUser(userId);\n    const companyRef = db.doc(`companies/${companyId}`);\n    \n    const validSettings: { [key: string]: any } = {};\n    if (typeof settings.exchangeRate === 'number') {\n        validSettings.exchangeRate = settings.exchangeRate;\n    }\n    if (typeof settings.pettyCashInitial === 'number') {\n        validSettings.pettyCashInitial = settings.pettyCashInitial;\n    }\n    if (typeof settings.name === 'string' && settings.name.length > 0) {\n        validSettings.name = settings.name;\n    }\n    if (typeof settings.logoUrl === 'string') {\n        validSettings.logoUrl = settings.logoUrl;\n    }\n\n    if (Object.keys(validSettings).length > 0) {\n        await companyRef.update(validSettings);\n    }\n}\n\n\n// -----------------\n// Gesti贸n de usuarios\n// -----------------\nexport async function addUser(userData: NewUserData, adminUserId: string) {\n    const auth = getAdminAuthOrThrow();\n    const db = getAdminDbOrThrow();\n    const companyId = await getCompanyIdForUser(adminUserId);\n\n    if (userData.role !== 'admin' && userData.role !== 'employee') {\n        throw new Error(\"Rol de usuario no v谩lido.\");\n    }\n\n    try {\n        const userRecord = await auth.createUser({\n            email: userData.email,\n            password: userData.password,\n            displayName: userData.name,\n        });\n        \n        await auth.setCustomUserClaims(userRecord.uid, { role: userData.role, companyId });\n\n        const newUserDocRef = db.doc(`users/${userRecord.uid}`);\n        await newUserDocRef.set({\n            uid: userRecord.uid,\n            name: userData.name,\n            email: userData.email,\n            role: userData.role,\n            companyId: companyId,\n            createdAt: FieldValue.serverTimestamp(),\n        });\n\n        return { uid: userRecord.uid };\n\n    } catch(error: any) {\n        if (error.code === 'auth/email-already-exists') {\n            throw new Error('Este correo electr贸nico ya est谩 registrado.');\n        }\n        console.error(\"Error creating user:\", error);\n        throw new Error('No se pudo crear el usuario. ' + error.message);\n    }\n};\n\nexport async function updateUserRole(userIdToUpdate: string, newRole: UserRole, currentAdminId: string) {\n    const auth = getAdminAuthOrThrow();\n    const db = getAdminDbOrThrow();\n\n    const [companyId, { customClaims: adminClaims }] = await Promise.all([\n        getCompanyIdForUser(currentAdminId),\n        auth.getUser(currentAdminId),\n    ]);\n\n    if (newRole === 'primary-admin') {\n        throw new Error(\"La transferencia de propiedad debe hacerse a trav茅s de la acci贸n 'transferPrimaryAdmin'.\");\n    }\n\n    const userToUpdateRef = db.doc(`users/${userIdToUpdate}`);\n    const userDoc = await userToUpdateRef.get();\n\n    if (!userDoc.exists || userDoc.data()?.companyId !== companyId) {\n        throw new Error(\"El usuario a modificar no pertenece a la misma empresa.\");\n    }\n\n    const targetUserRole = userDoc.data()?.role;\n\n    if (adminClaims?.role === 'admin' && (targetUserRole === 'admin' || targetUserRole === 'primary-admin')) {\n        throw new Error(\"Un administrador no puede modificar a otro administrador o al propietario.\");\n    }\n    \n    await auth.setCustomUserClaims(userIdToUpdate, { role: newRole, companyId });\n    await userToUpdateRef.update({ role: newRole });\n}\n\n\nexport async function transferPrimaryAdmin(targetUserId: string, currentAdminId: string) {\n    const auth = getAdminAuthOrThrow();\n    const db = getAdminDbOrThrow();\n\n    const { customClaims: adminClaims } = await auth.getUser(currentAdminId);\n\n    if (adminClaims?.role !== 'primary-admin') {\n        throw new Error(\"Solo el propietario actual puede transferir la propiedad.\");\n    }\n\n    const companyId = adminClaims.companyId;\n\n    const targetUserRef = db.doc(`users/${targetUserId}`);\n    const targetUserDoc = await targetUserRef.get();\n\n    if (!targetUserDoc.exists || targetUserDoc.data()?.companyId !== companyId) {\n        throw new Error(\"El usuario objetivo no pertenece a la misma empresa.\");\n    }\n    \n    const batch = db.batch();\n    const currentAdminUserRef = db.doc(`users/${currentAdminId}`);\n\n    // Update custom claims\n    await Promise.all([\n        auth.setCustomUserClaims(targetUserId, { role: 'primary-admin', companyId }),\n        auth.setCustomUserClaims(currentAdminId, { role: 'admin', companyId })\n    ]);\n    \n    // Update user documents in Firestore\n    batch.update(targetUserRef, { role: 'primary-admin' });\n    batch.update(currentAdminUserRef, { role: 'admin' });\n    \n    await batch.commit();\n}\n\n\nexport async function deleteUser(userIdToDelete: string, currentAdminId: string) {\n    const auth = getAdminAuthOrThrow();\n    const db = getAdminDbOrThrow();\n    const companyId = await getCompanyIdForUser(currentAdminId);\n\n    const userToDeleteRef = db.doc(`users/${userIdToDelete}`);\n    const userDoc = await userToDeleteRef.get();\n\n    if (!userDoc.exists || userDoc.data()?.companyId !== companyId) {\n        throw new Error(\"El usuario a eliminar no pertenece a tu empresa.\");\n    }\n\n    if (userDoc.data()?.role === 'primary-admin') {\n        throw new Error(\"No se puede eliminar al propietario de la empresa.\");\n    }\n\n    await auth.deleteUser(userIdToDelete);\n    await userToDeleteRef.delete();\n}\n\n\n// -----------------\n// Category Management\n// -----------------\nexport async function addCategory(categoryName: string, userId: string): Promise<string> {\n    const db = getAdminDbOrThrow();\n    const companyId = await getCompanyIdForUser(userId);\n    const categoryCollection = db.collection(`companies/${companyId}/categories`);\n    \n    const existingCategoryQuery = await categoryCollection.where('name', '==', categoryName).limit(1).get();\n    if (!existingCategoryQuery.empty) {\n        return existingCategoryQuery.docs[0].id;\n    }\n    \n    const newCategoryRef = await categoryCollection.add({ name: categoryName });\n    return newCategoryRef.id;\n};\n\nexport async function deleteCategory(categoryId: string, userId: string): Promise<void> {\n    const db = getAdminDbOrThrow();\n    const companyId = await getCompanyIdForUser(userId);\n    \n    const categoryRef = db.doc(`companies/${companyId}/categories/${categoryId}`);\n    const productsRef = db.collection(`companies/${companyId}/products`);\n    \n    const productsQuery = productsRef.where('categoryId', '==', categoryId);\n    const productsSnapshot = await productsQuery.get();\n    \n    const batch = db.batch();\n    \n    productsSnapshot.forEach(doc => {\n      batch.update(doc.ref, { categoryId: \"\" });\n    });\n    \n    batch.delete(categoryRef);\n    \n    await batch.commit();\n};\n\n\n// -----------------\n// Product Management\n// -----------------\nexport async function addProduct(productData: Omit<Product, 'id'>, userId: string): Promise<void> {\n    const db = getAdminDbOrThrow();\n    const companyId = await getCompanyIdForUser(userId);\n    const productCollection = db.collection(`companies/${companyId}/products`);\n    await productCollection.add({\n        ...productData,\n        createdAt: FieldValue.serverTimestamp(),\n    });\n};\n\nexport async function addMultipleProducts(productsData: Omit<Product, 'id'>[], userId: string): Promise<{ successCount: number; errorCount: number; }> {\n    const db = getAdminDbOrThrow();\n    const companyId = await getCompanyIdForUser(userId);\n    const productCollection = db.collection(`companies/${companyId}/products`);\n    \n    let successCount = 0;\n    let errorCount = 0;\n\n    const batchSize = 500;\n    for (let i = 0; i < productsData.length; i += batchSize) {\n        const batch = db.batch();\n        const chunk = productsData.slice(i, i + batchSize);\n        \n        for (const productData of chunk) {\n            try {\n                const docRef = productCollection.doc();\n                batch.set(docRef, { ...productData, createdAt: FieldValue.serverTimestamp() });\n                successCount++;\n            } catch (e) {\n                console.error(\"Error adding product to batch:\", productData.name, e);\n                errorCount++;\n            }\n        }\n        await batch.commit();\n    }\n\n    return { successCount, errorCount };\n}\n\n\nexport async function updateProduct(productId: string, productData: Partial<Product>, userId: string): Promise<void> {\n    const db = getAdminDbOrThrow();\n    const companyId = await getCompanyIdForUser(userId);\n    const productRef = db.doc(`companies/${companyId}/products/${productId}`);\n    await productRef.update(productData);\n};\n\nexport async function deleteProduct(productId: string, userId: string): Promise<void> {\n    const db = getAdminDbOrThrow();\n    const companyId = await getCompanyIdForUser(userId);\n    const productRef = db.doc(`companies/${companyId}/products/${productId}`);\n    await productRef.delete();\n};\n\n\n// -----------------\n// Order Draft Management\n// -----------------\nexport async function addOrderDraft(title: string, items: OrderItem[], totalCost: number, userId: string): Promise<void> {\n    const db = getAdminDbOrThrow();\n    const companyId = await getCompanyIdForUser(userId);\n    const draftsCollection = db.collection(`companies/${companyId}/orderDrafts`);\n    await draftsCollection.add({\n        title,\n        items,\n        totalCost,\n        status: 'draft',\n        createdAt: FieldValue.serverTimestamp(),\n    });\n}\n\nexport async function deleteOrderDraft(draftId: string, userId: string): Promise<void> {\n    const db = getAdminDbOrThrow();\n    const companyId = await getCompanyIdForUser(userId);\n    const draftRef = db.doc(`companies/${companyId}/orderDrafts/${draftId}`);\n    await draftRef.delete();\n}\n\nexport async function restockInventory(drafts: OrderDraft[], userId: string): Promise<string> {\n    const db = getAdminDbOrThrow();\n    const companyId = await getCompanyIdForUser(userId);\n\n    const consolidatedItems = new Map<string, number>();\n    let totalCost = 0;\n    \n    drafts.forEach(draft => {\n        totalCost += draft.totalCost;\n        draft.items.forEach(item => {\n            consolidatedItems.set(item.productId, (consolidatedItems.get(item.productId) || 0) + item.orderQuantity);\n        });\n    });\n\n    const newOutflow: Omit<CashOutflow, 'id'> = {\n        date: new Date().toISOString(),\n        amount: totalCost,\n        currency: 'NIO', // Assuming restock is always in NIO\n        cashBox: 'general',\n        reason: `Abastecimiento de inventario (${drafts.length} borrador/es)`,\n        type: 'restock',\n    };\n\n    const outflowId = await db.runTransaction(async (transaction) => {\n        // --- READS ---\n        const productRefs = Array.from(consolidatedItems.keys()).map(productId => db.doc(`companies/${companyId}/products/${productId}`));\n        const productDocs = productRefs.length > 0 ? await transaction.getAll(...productRefs) : [];\n        const productsToUpdate: { ref: FirebaseFirestore.DocumentReference, newStock: number }[] = [];\n\n        for (const productDoc of productDocs) {\n            const orderQuantity = consolidatedItems.get(productDoc.id);\n            if (productDoc.exists && orderQuantity) {\n                const currentStock = productDoc.data()?.quantity || 0;\n                const newStock = currentStock + orderQuantity;\n                productsToUpdate.push({ ref: productDoc.ref, newStock });\n            }\n        }\n        \n        // --- WRITES ---\n        // 1. Create the cash outflow document\n        const outflowRef = db.collection(`companies/${companyId}/cash_outflows`).doc();\n        transaction.set(outflowRef, newOutflow);\n        \n        // 2. Update stock for all products\n        productsToUpdate.forEach(p => {\n            transaction.update(p.ref, { quantity: p.newStock });\n        });\n\n        // 3. Mark drafts as completed\n        drafts.forEach(draft => {\n            const draftRef = db.doc(`companies/${companyId}/orderDrafts/${draft.id}`);\n            transaction.update(draftRef, { status: 'completed' });\n        });\n        \n        return outflowRef.id;\n    });\n\n    return outflowId;\n}\n\n\n// -----------------\n// Sales Management\n// -----------------\nexport async function addSale(newSale: Omit<Sale, 'id' | 'reviewNotes'>, cart: PlainCartItem[], userId: string): Promise<string> {\n    const db = getAdminDbOrThrow();\n    const companyId = await getCompanyIdForUser(userId);\n    \n    const saleId = await db.runTransaction(async (transaction) => {\n        // --- 1. READS ---\n        const productRefs = cart.map(item => db.doc(`companies/${companyId}/products/${item.id}`));\n        const productDocs = productRefs.length > 0 ? await transaction.getAll(...productRefs) : [];\n        const productsToUpdate: { ref: FirebaseFirestore.DocumentReference, newStock: number }[] = [];\n\n        for (let i = 0; i < productDocs.length; i++) {\n            const productDoc = productDocs[i];\n            const cartItem = cart[i];\n\n            if (!productDoc.exists) {\n                throw new Error(`Producto con ID ${cartItem.id} no encontrado.`);\n            }\n\n            const currentStock = productDoc.data()?.quantity || 0;\n            const newStock = currentStock - cartItem.quantityInCart;\n\n            if (newStock < 0) {\n                throw new Error(`Stock insuficiente para ${productDoc.data()?.name}.`);\n            }\n            productsToUpdate.push({ ref: productDoc.ref, newStock });\n        }\n\n        // --- 2. WRITES ---\n        const salesCollection = db.collection(`companies/${companyId}/sales`);\n        const saleRef = salesCollection.doc();\n        transaction.set(saleRef, newSale);\n\n        productsToUpdate.forEach(p => {\n            transaction.update(p.ref, { quantity: p.newStock });\n        });\n        \n        return saleRef.id;\n    });\n\n    return saleId;\n};\n\nexport async function updateSaleAndAdjustStock(updatedSale: Sale, originalSale: Sale, userId: string): Promise<void> {\n    const db = getAdminDbOrThrow();\n    const companyId = await getCompanyIdForUser(userId);\n    \n    await db.runTransaction(async (transaction) => {\n        const saleRef = db.doc(`companies/${companyId}/sales/${updatedSale.id}`);\n        const productQuantityChanges: { [productId: string]: number } = {};\n\n        // Calculate deltas: Positive value means stock should increase (product returned)\n        originalSale.items.forEach(item => {\n            productQuantityChanges[item.productId] = (productQuantityChanges[item.productId] || 0) + item.quantity;\n        });\n\n        updatedSale.items.forEach(item => {\n            productQuantityChanges[item.productId] = (productQuantityChanges[item.productId] || 0) - item.quantity;\n        });\n\n        // --- READS ---\n        const productRefsToRead = Object.keys(productQuantityChanges)\n            .filter(productId => productQuantityChanges[productId] !== 0)\n            .map(productId => db.doc(`companies/${companyId}/products/${productId}`));\n        \n        const productDocs = productRefsToRead.length > 0 ? await transaction.getAll(...productRefsToRead) : [];\n        \n        // --- WRITES ---\n        const updates: { ref: FirebaseFirestore.DocumentReference, newStock: number }[] = [];\n\n        for (const productDoc of productDocs) {\n            if (!productDoc.exists) continue; // Skip if product somehow got deleted\n            const productId = productDoc.id;\n            const delta = productQuantityChanges[productId];\n            const currentStock = productDoc.data()?.quantity || 0;\n            const newStock = currentStock + delta;\n\n            if (newStock < 0) {\n                const productName = productDoc.data()?.name || productId;\n                throw new Error(`No se puede completar la actualizaci贸n. El stock de \"${productName}\" ser铆a negativo.`);\n            }\n            updates.push({ ref: productDoc.ref, newStock });\n        }\n\n        // Create refund outflow if necessary\n        const refundAmount = originalSale.grandTotal - updatedSale.grandTotal;\n        if (refundAmount > 0) {\n            const outflowRef = db.collection(`companies/${companyId}/cash_outflows`).doc();\n            transaction.set(outflowRef, {\n                date: new Date().toISOString(),\n                amount: refundAmount,\n                currency: originalSale.paymentCurrency,\n                cashBox: 'general',\n                reason: `Ajuste/reembolso de Venta ID: ${originalSale.id.substring(0,8)}...`,\n                type: 'adjustment' as const,\n            });\n        }\n        \n        // Update the sale document\n        transaction.update(saleRef, {\n            items: updatedSale.items,\n            grandTotal: updatedSale.grandTotal,\n            needsReview: false,\n            reviewNotes: FieldValue.delete() // Remove notes after review\n        });\n\n        // Apply stock updates\n        updates.forEach(update => {\n            transaction.update(update.ref, { quantity: update.newStock });\n        });\n    });\n};\n\nexport async function markSaleForReview(saleId: string, notes: string, userId: string): Promise<void> {\n    const db = getAdminDbOrThrow();\n    const companyId = await getCompanyIdForUser(userId);\n    const saleRef = db.doc(`companies/${companyId}/sales/${saleId}`);\n    await saleRef.update({ needsReview: true, reviewNotes: notes });\n}\n\n// -----------------\n// Inventory Loss Management\n// -----------------\n\nexport async function adjustStockForLoss(productId: string, lostQuantity: number, reason: string, userId: string): Promise<void> {\n    const db = getAdminDbOrThrow();\n    const companyId = await getCompanyIdForUser(userId);\n\n    await db.runTransaction(async (transaction) => {\n        const productRef = db.doc(`companies/${companyId}/products/${productId}`);\n        const productDoc = await transaction.get(productRef);\n\n        if (!productDoc.exists) {\n            throw new Error(\"El producto que intentas ajustar no existe.\");\n        }\n\n        const productData = productDoc.data() as Product;\n        const currentStock = productData.quantity;\n        const newStock = currentStock - lostQuantity;\n\n        if (newStock < 0) {\n            throw new Error(`La cantidad a dar de baja (${lostQuantity}) es mayor que el stock actual (${currentStock}).`);\n        }\n\n        const lossValue = productData.purchaseCost * lostQuantity;\n\n        const outflowRef = db.collection(`companies/${companyId}/cash_outflows`).doc();\n        transaction.set(outflowRef, {\n            date: new Date().toISOString(),\n            amount: lossValue,\n            currency: 'NIO', // Losses are always calculated in base currency\n            cashBox: 'general', // This is a virtual outflow from 'general' box\n            reason: `P茅rdida de ${lostQuantity} ${productData.stockingUnit} de \"${productData.name}\": ${reason}`,\n            type: 'loss' as const,\n        });\n\n        transaction.update(productRef, { quantity: newStock });\n    });\n}\n\n\n// -----------------\n// Cash Flow & Reconciliation\n// -----------------\n\nexport async function addCashOutflow(outflow: Omit<CashOutflow, 'id'>, userId: string): Promise<string> {\n    const db = getAdminDbOrThrow();\n    const companyId = await getCompanyIdForUser(userId);\n    const outflowsCollection = db.collection(`companies/${companyId}/cash_outflows`);\n    const docRef = await outflowsCollection.add(outflow);\n    return docRef.id;\n};\n\nexport async function addWithdrawal(withdrawalData: Omit<CashOutflow, 'id'>, userId: string): Promise<string> {\n    const db = getAdminDbOrThrow();\n    const companyId = await getCompanyIdForUser(userId);\n    const outflowsCollection = db.collection(`companies/${companyId}/cash_outflows`);\n    \n    const outflowToCreate: Omit<CashOutflow, 'id'> = {\n        ...withdrawalData,\n        type: 'withdrawal',\n    };\n\n    const docRef = await outflowsCollection.add(outflowToCreate);\n    return docRef.id;\n}\n\nexport async function addInflow(inflow: Omit<Inflow, 'id'>, userId: string): Promise<void> {\n    const db = getAdminDbOrThrow();\n    const companyId = await getCompanyIdForUser(userId);\n    const inflowsCollection = db.collection(`companies/${companyId}/inflows`);\n    await inflowsCollection.add(inflow);\n};\n\nexport async function addCashTransfer(transfer: Omit<CashTransfer, 'id'>, userId: string): Promise<void> {\n    const db = getAdminDbOrThrow();\n    const companyId = await getCompanyIdForUser(userId);\n    const transfersCollection = db.collection(`companies/${companyId}/cash_transfers`);\n    await transfersCollection.add(transfer);\n};\n\nexport async function updateReconciliationStatus(dateId: string, status: 'open' | 'closed', userId: string): Promise<void> {\n    const db = getAdminDbOrThrow();\n    const companyId = await getCompanyIdForUser(userId);\n    const reconRef = db.doc(`companies/${companyId}/reconciliations/${dateId}`);\n    await reconRef.set({\n        status: status,\n        updatedAt: FieldValue.serverTimestamp()\n    }, { merge: true });\n};\n\n\n// -----------------\n// Danger Zone\n// -----------------\n\nexport async function setCompanySecurityCode(password: string, securityCode: string, userId: string): Promise<void> {\n    const auth = getAdminAuthOrThrow();\n    const db = getAdminDbOrThrow();\n    \n    const { customClaims, email } = await auth.getUser(userId);\n\n    if (customClaims?.role !== 'primary-admin' || !email) {\n        throw new Error(\"Solo el propietario puede configurar un c贸digo de seguridad.\");\n    }\n    \n    try {\n        if (!clientAuth.currentUser) {\n            await signInWithEmailAndPassword(clientAuth, email, password);\n        }\n        const userCredential = EmailAuthProvider.credential(email, password);\n        await reauthenticateWithCredential(clientAuth.currentUser!, userCredential);\n    } catch(e) {\n        throw new Error(\"No se pudo reautenticar. La contrase帽a actual es incorrecta.\");\n    }\n\n    const companyId = await getCompanyIdForUser(userId);\n    const companyRef = db.doc(`companies/${companyId}`);\n    const securityDocRef = db.doc(`companies/${companyId}/private/security`);\n\n    await securityDocRef.set({ code: securityCode });\n    await companyRef.update({ securityCodeSet: true });\n}\n\nexport async function initiateCompanyWipe(password: string, securityCode: string, userId: string): Promise<any> {\n    const auth = getAdminAuthOrThrow();\n    const { email } = await auth.getUser(userId);\n    \n    if (!email) {\n        throw new Error(\"El usuario no tiene un email para reautenticar.\");\n    }\n\n    try {\n        if (!clientAuth.currentUser) {\n           await signInWithEmailAndPassword(clientAuth, email, password);\n        }\n        const userCredential = EmailAuthProvider.credential(email, password);\n        await reauthenticateWithCredential(clientAuth.currentUser!, userCredential);\n    } catch(e) {\n        throw new Error(\"No se pudo reautenticar. La contrase帽a actual es incorrecta.\");\n    }\n\n    const db = getAdminDbOrThrow();\n    const companyId = await getCompanyIdForUser(userId);\n    const securityDocRef = db.doc(`companies/${companyId}/private/security`);\n    const securityDoc = await securityDocRef.get();\n    \n    if (!securityDoc.exists || securityDoc.data()?.code !== securityCode) {\n        throw new Error(\"El c贸digo de seguridad es incorrecto.\");\n    }\n    \n    const functions = getFunctions(clientApp);\n    const wipeCompanyData: HttpsCallable = httpsCallable(functions, 'wipeCompanyData');\n\n    try {\n        const result = await wipeCompanyData();\n        return result.data;\n    } catch (error: any) {\n        console.error(\"Error al invocar la funci贸n de borrado:\", error);\n        throw new Error(error.message || \"Error desconocido al llamar a la funci贸n de borrado.\");\n    }\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 957, "column": 0}, "map": {"version":3,"sources":["file:///home/user/tienda/.next-internal/server/app/register/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {isInitialSetupRequired as '003e55ce336b04d3a13975537d10e57747b5e9f2bb'} from 'ACTIONS_MODULE0'\nexport {createInitialAdminUser as '40b4177845e77e8779f45ba6afa1f228a6a569e41b'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA","debugId":null}},
    {"offset": {"line": 998, "column": 0}, "map": {"version":3,"sources":["file:///home/user/tienda/src/app/register/page.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/register/page.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/register/page.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAA6R,GAC1T,2DACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1012, "column": 0}, "map": {"version":3,"sources":["file:///home/user/tienda/src/app/register/page.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/register/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/register/page.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAyQ,GACtS,uCACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1026, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}}]
}